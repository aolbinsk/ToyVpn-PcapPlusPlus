<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="742.0326761048232" height="522.0879476528181"><desc>title%20Establish%20VPN%20Connection%0A%0Aparticipant%20App%0Aparticipant%20ToyVpnService%0Aparticipant%20VPN%20Server%0A%0AApp-%3EToyVpnService%3A%20Connect%20to%20server%20(server%20address%2C%20port%2C%20secret)%0AToyVpnService-%3EVPN%20Server%3A%20Open%20a%20UDP%20connection%0AToyVpnService-%3EVPN%20Server%3A%20Send%20the%20secret%0AVPN%20Server-%3EToyVpnService%3A%20Send%20VPN%20settings%3A%5Cn%20%20-%20Client%20address%5Cn%20%20-%20MTU%5Cn%20%20-%20Route%20address%5Cn%20%20-%20DNS%20server%0AToyVpnService-%3EToyVpnService%3A%20Set%20up%20and%20establish%20VPN%20on%20the%20device%0AToyVpnService-%3EApp%3A%20Broadcast%20message%3A%20VPN%20connected%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="742" height="522"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 38.90796364285352 95.73914152281817 L 38.90796364285352 522.0879476528181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 389.7518386008939 95.73914152281817 L 389.7518386008939 522.0879476528181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 677.5163788743232 95.73914152281817 L 677.5163788743232 522.0879476528181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.63409261281818 L 69.64832563570704 51.63409261281818 L 69.64832563570704 95.73914152281817 L 8.167601650000002 95.73914152281817 L 8.167601650000002 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">App</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 323.23647508216146 51.63409261281818 L 456.2672021196263 51.63409261281818 L 456.2672021196263 95.73914152281817 L 323.23647508216146 95.73914152281817 L 323.23647508216146 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.9601706626615" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ToyVpnService</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 621.1676832938232 51.63409261281818 L 733.8650744548232 51.63409261281818 L 733.8650744548232 95.73914152281817 L 621.1676832938232 95.73914152281817 L 621.1676832938232 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.8913788743232" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">VPN Server</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="246.39999961853027" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Establish VPN Connection</text></g><g><rect fill="white" stroke="none" x="58.2379542145202" y="128.4095481228182" width="312.1838861853125" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.6882347095202" y="143.1112310928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Connect to server (server address, port, secret)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 38.90796364285352 149.64531241281819 L 376.30252121722725 149.64531241281819" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(389.7518386008939,149.64531241281819) translate(-389.7518386008939,-149.64531241281819)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 376.1391691842272 142.83897770448485 L 389.7518386008939 149.64531241281819 L 376.1391691842272 156.45164712115152 Z"/></g></g><g><rect fill="white" stroke="none" x="452.30049551326897" y="174.1481173628182" width="162.66722358765625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="454.750776008269" y="188.84980033281818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Open a UDP connection</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 389.7518386008939 195.3838816528182 L 664.0670614906566 195.3838816528182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(677.5163788743232,195.3838816528182) translate(-677.5163788743232,-195.3838816528182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 663.9037094576565 188.57754694448485 L 677.5163788743232 195.3838816528182 L 663.9037094576565 202.19021636115153 Z"/></g></g><g><rect fill="white" stroke="none" x="479.95049370128777" y="219.8866866028182" width="107.36722816529297" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="482.4007741962878" y="234.58836957281818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send the secret</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 389.7518386008939 241.1224508928182 L 664.0670614906566 241.1224508928182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(677.5163788743232,241.1224508928182) translate(-677.5163788743232,-241.1224508928182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 663.9037094576565 234.31611618448486 L 677.5163788743232 241.1224508928182 L 663.9037094576565 247.92878560115153 Z"/></g></g><g><rect fill="white" stroke="none" x="467.7421606858459" y="265.6252558428182" width="131.78389228882813" height="21.23576429"/><rect fill="white" stroke="none" x="467.7421606858459" y="281.9604591428182" width="115.46722663941406" height="21.23576429"/><rect fill="white" stroke="none" x="467.7421606858459" y="298.2956624428182" width="53.65056099" height="21.23576429"/><rect fill="white" stroke="none" x="467.7421606858459" y="314.6308657428182" width="117.10055793824219" height="21.23576429"/><rect fill="white" stroke="none" x="467.7421606858459" y="330.96606904281816" width="97.56722511353516" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="470.1924411808459" y="280.3269388128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send VPN settings:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="470.1924411808459" y="296.6621421128182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  - Client address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="470.1924411808459" y="312.99734541281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  - MTU</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="470.1924411808459" y="329.33254871281815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  - Route address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="470.1924411808459" y="345.66775201281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  - DNS server</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 677.5163788743232 352.2018333328182 L 403.20115598456056 352.2018333328182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(389.7518386008939,352.2018333328182) translate(-389.7518386008939,-352.2018333328182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 403.3645080175606 345.39549862448484 L 389.7518386008939 352.2018333328182 L 403.3645080175606 359.0081680411515 Z"/></g></g><g><rect fill="white" stroke="none" x="409.08182917256056" y="376.70463828281817" width="262.7172418982031" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="411.5321096675606" y="391.40632125281815" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Set up and establish VPN on the device</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 389.7518386008939 397.94040257281813 L 455.0926518008939 397.94040257281813 L 455.0926518008939 419.17616686281815 L 403.20115598456056 419.17616686281815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(389.7518386008939,419.17616686281815) translate(-389.7518386008939,-419.17616686281815)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 403.3645080175606 412.3698321544848 L 389.7518386008939 419.17616686281815 L 403.3645080175606 425.9825015711515 Z"/></g></g><g><rect fill="white" stroke="none" x="92.33795459598993" y="443.67897181281813" width="243.98388923707031" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="94.78823509098993" y="458.3806547828181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Broadcast message: VPN connected</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 389.7518386008939 464.91473610281815 L 52.357281026520184 464.91473610281815" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(38.90796364285352,464.91473610281815) translate(-38.90796364285352,-464.91473610281815)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 52.520633059520186 458.1084013944848 L 38.90796364285352 464.91473610281815 L 52.520633059520186 471.7210708111515 Z"/></g></g></g><g/><g/><g/></g></svg>